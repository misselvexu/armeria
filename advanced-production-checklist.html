

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Production checklist &mdash; Armeria 0.84.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Zipkin integration" href="advanced-zipkin.html" />
    <link rel="prev" title="Unit-testing Client and Service" href="advanced-unit-testing.html" />
  <script src="_static/center_page.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
   


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/armeria.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.84
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setting up a project</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Writing a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Writing a client</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="advanced.html">Advanced topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="advanced-logging.html">Logging contextual information</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-structured-logging.html">Structured logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-custom-attributes.html"><tt class="docutils literal">RequestContext</tt> custom attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-structured-logging-kafka.html">Structured logging with Kafka</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-unit-testing.html">Unit-testing <tt class="docutils literal">Client</tt> and <tt class="docutils literal">Service</tt></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Production checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-zipkin.html">Zipkin integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-zookeeper.html">Service discovery with ZooKeeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-saml.html">SAML Single Sign-On</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-spring-webflux-integration.html">Using Armeria with Spring WebFlux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/armeria/releases">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="apidocs/index.html#://">API documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="xref/index.html#://">Source cross-reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/armeria/issues?q=label%3Aquestion">Questions and answers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/armeria">Fork me at GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/armeria/blob/master/CONTRIBUTING.md">Contributing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Armeria</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="advanced.html">Advanced topics</a> &raquo;</li>
        
      <li>Production checklist</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/line/armeria/blob/master/site/src/sphinx/advanced-production-checklist.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="production-checklist">
<span id="advanced-production-checklist"></span><h1>Production checklist<a class="headerlink" href="#production-checklist" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that the advices in this page are not always applicable for every use case and thus should be
applied with caution. Do not apply the changes you really do not need.</p>
</div>
<p>You may want to consider the following options before putting your Armeria application into production.</p>
<ul>
<li><p class="first">Specify the maximum number of accepted connections. The default is <em>unbounded</em>.</p>
<div class="highlight-java notranslate"><div class="highlight hljs"><pre class="java">import com.linecorp.armeria.server.ServerBuilder;

ServerBuilder sb = new ServerBuilder();
sb.maxNumConnections(500);</pre></div>
</div>
</li>
<li><p class="first">Specify an alternative <tt class="docutils literal">blockingTaskExecutor</tt> based on expected workload if your server has
a <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/server/Service.html">Service</a></code> that uses it, such as <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/server/tomcat/TomcatService.html">TomcatService</a></code>, <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/server/jetty/JettyService.html">JettyService</a></code> and <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/server/thrift/THttpService.html">THttpService</a></code> with
synchronous service implementation. The default is a simple <tt class="docutils literal">ThreadPoolExecutor</tt> with 200 threads and an
<em>unbounded</em> queue, provided by <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/common/CommonPools.html">CommonPools</a></code>.</p>
<div class="highlight-java notranslate"><div class="highlight hljs"><pre class="java">import com.linecorp.armeria.server.ServerBuilder;

ServerBuilder sb = new ServerBuilder();
sb.blockingTaskExecutor(myBoundedExecutor);</pre></div>
</div>
</li>
<li><p class="first">Specify the default limits of an HTTP request or response.</p>
<div class="highlight-java notranslate"><div class="highlight hljs"><pre class="java">import java.time.Duration;
import com.linecorp.armeria.client.ClientBuilder;
import com.linecorp.armeria.server.ServerBuilder;

// Server-side
ServerBuilder sb = new ServerBuilder();
sb.defaultMaxRequestLength(1048576); // bytes (default: 10 MiB)
sb.defaultRequestTimeout(Duration.ofSeconds(7)); // (default: 10 seconds)

// Client-side
ClientBuilder cb = new ClientBuilder(...); // or HttpClientBuilder
cb.defaultMaxResponseLength(1048576); // bytes (default: 10 MiB)
cb.defaultResponseTimeout(Duration.ofSeconds(10)); // (default: 15 seconds)</pre></div>
</div>
</li>
<li><p class="first">Decorate your services with <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/server/throttling/ThrottlingService.html">ThrottlingService</a></code> which lets you fail the incoming requests based on a
policy, such as ‘fail if the rate of requests exceed a certain threshold.’</p>
<div class="highlight-java notranslate"><div class="highlight hljs"><pre class="java">import com.linecorp.armeria.server.throttling.RateLimitingThrottlingStrategy;
import com.linecorp.armeria.server.throttling.ThrottlingHttpService;

ServerBuilder sb = new ServerBuilder();
sb.service(&quot;/my_service&quot;, // Allow up to 1000 requests/sec.
           myService.decorate(ThrottlingHttpService.newDecorator(
                   new RateLimitingThrottlingStrategy(1000.0))));</pre></div>
</div>
</li>
<li><p class="first">Decorate your clients with <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/client/retry/RetryingClient.html">RetryingClient</a></code>. See <a class="reference internal" href="client-retry.html#client-retry"><span class="std std-ref">Automatic retry</span></a>.</p>
</li>
<li><p class="first">Decorate your clients with <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerClient.html">CircuitBreakerClient</a></code>. See <a class="reference internal" href="client-circuit-breaker.html#client-circuit-breaker"><span class="std std-ref">Circuit breaker</span></a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You can use Armeria’s <code class="code api-reference docutils literal javadoc"><a class="code api-reference reference external javadoc" href="apidocs/com/linecorp/armeria/client/circuitbreaker/CircuitBreaker.html">CircuitBreaker</a></code> API for non-Armeria clients without circuit breaker support.
See <a class="reference internal" href="client-circuit-breaker.html#circuit-breaker-with-non-armeria-client"><span class="std std-ref">Using CircuitBreaker with non-Armeria client</span></a>.</p>
</div>
</li>
<li><p class="first">Tune the socket options.</p>
<div class="highlight-java notranslate"><div class="highlight hljs"><pre class="java">import com.linecorp.armeria.client.ClientBuilder;
import com.linecorp.armeria.client.ClientFactory;
import com.linecorp.armeria.client.ClientFactoryBuilder;
import com.linecorp.armeria.server.ServerBuilder;
import io.netty.channel.ChannelOption;

// Server-side
ServerBuilder sb = new ServerBuilder();
sb.channelOption(ChannelOption.SO_BACKLOG, ...);
sb.channelOption(ChannelOption.SO_SNDBUF, ...);
sb.channelOption(ChannelOption.SO_RCVBUF, ...);

// Client-side
ClientFactoryBuilder cfb = new ClientFactoryBuilder();
cfb.channelOption(ChannelOption.SO_REUSEADDR, ...);
cfb.channelOption(ChannelOption.SO_SNDBUF, ...);
cfb.channelOption(ChannelOption.SO_RCVBUF, ...);
ClientFactory cf = cfb.build();
ClientBuilder cb = new ClientBuilder(...);
cb.factory(cf);</pre></div>
</div>
</li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advanced-zipkin.html" class="btn btn-neutral float-right" title="Zipkin integration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="advanced-unit-testing.html" class="btn btn-neutral" title="Unit-testing Client and Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, LINE Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  <div class="github-fork-ribbon-wrapper right">
    <div class="github-fork-ribbon">
      <a href="https://github.com/line/armeria">Fork me at GitHub</a>
    </div>
  </div>
  <script type="text/javascript" src="_static/add_badges.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/gradle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/protobuf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/thrift.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.6.0/highlightjs-line-numbers.min.js"></script>
  <script>
    document.querySelectorAll('div.hljs > pre').forEach(function(block) {
      hljs.highlightBlock(block);
      hljs.lineNumbersBlock(block);
    });
  </script>
   


</body>
</html>